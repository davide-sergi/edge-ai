{"version":3,"sources":["webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/markdown/style/index.css","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/markdown/style/markdown.css","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/markdown/style/tomorrow.css","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/style/index.css","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/style/preview-widget.css","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/markdown/index.ts","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/markdown/markdown-preview-handler.ts","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/preview-contribution.ts","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/preview-frontend-module.ts","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/preview-handler.ts","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/preview-link-normalizer.ts","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/preview-preferences.ts","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/preview-uri.ts","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/preview-widget.ts","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/markdown/style/index.css?4943","webpack:////Users/sergi/work/projects/edge-ai/theia/theia-ide-1.1.0/packages/preview/src/browser/style/index.css?9f1b"],"names":[],"mappings":"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","file":"72.bundle.js","sourcesContent":["exports = module.exports = require(\"../../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\nexports.i(require(\"-!../../../../../../node_modules/css-loader/index.js!./markdown.css\"), \"\");\nexports.i(require(\"-!../../../../../../node_modules/css-loader/index.js!./tomorrow.css\"), \"\");\n\n// module\nexports.push([module.id, \"/********************************************************************************\\n * Copyright (C) 2018 TypeFox and others.\\n *\\n * This program and the accompanying materials are made available under the\\n * terms of the Eclipse Public License v. 2.0 which is available at\\n * http://www.eclipse.org/legal/epl-2.0.\\n *\\n * This Source Code may also be made available under the following Secondary\\n * Licenses when the conditions for such availability set forth in the Eclipse\\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\\n * with the GNU Classpath Exception which is available at\\n * https://www.gnu.org/software/classpath/license.html.\\n *\\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\\n ********************************************************************************/\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"/********************************************************************************\\n * Copyright (C) 2018 TypeFox and others.\\n *\\n * This program and the accompanying materials are made available under the\\n * terms of the Eclipse Public License v. 2.0 which is available at\\n * http://www.eclipse.org/legal/epl-2.0.\\n *\\n * This Source Code may also be made available under the following Secondary\\n * Licenses when the conditions for such availability set forth in the Eclipse\\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\\n * with the GNU Classpath Exception which is available at\\n * https://www.gnu.org/software/classpath/license.html.\\n *\\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\\n ********************************************************************************/\\n\\n/*---------------------------------------------------------------------------------------------\\n *  Copyright (c) Microsoft Corporation. All rights reserved.\\n *  Licensed under the MIT License. See License.txt in the project root for license information.\\n *--------------------------------------------------------------------------------------------*/\\n\\n.markdown-preview {\\n\\tfont-family: var(--theia-ui-font-family);\\n\\tfont-size: 14px;\\n\\tpadding: 0 26px;\\n\\tline-height: var(--theia-content-line-height);\\n\\tword-wrap: break-word;\\n}\\n\\n.markdown-preview:focus {\\n    outline: 0;\\n    box-shadow: none;\\n}\\n\\n.markdown-preview .line {\\n\\tposition: relative;\\n}\\n\\n.markdown-preview .line:hover:before {\\n\\tcontent: \\\"\\\";\\n\\tdisplay: block;\\n\\tposition: absolute;\\n\\ttop: 0;\\n\\tleft: -12px;\\n\\theight: 100%;\\n}\\n\\n.markdown-preview li.line:hover:before {\\n\\tleft: -30px;\\n}\\n\\n.markdown-preview .line:hover:before {\\n\\tborder-left: 3px solid var(--theia-editor-foreground);\\n}\\n\\n.markdown-preview .line .line:hover:before {\\n\\tborder-left: none;\\n}\\n\\n.markdown-preview img {\\n\\tmax-width: 100%;\\n\\tmax-height: 100%;\\n}\\n\\n.markdown-preview a {\\n\\ttext-decoration: none;\\n}\\n\\n.markdown-preview a:hover {\\n\\ttext-decoration: underline;\\n}\\n\\n.markdown-preview a:focus,\\n.markdown-preview input:focus,\\n.markdown-preview select:focus,\\n.markdown-preview textarea:focus {\\n\\toutline: 1px solid -webkit-focus-ring-color;\\n\\toutline-offset: -1px;\\n}\\n\\n.markdown-preview hr {\\n\\tborder: 0;\\n\\theight: 2px;\\n\\tborder-bottom: 2px solid;\\n}\\n\\n.markdown-preview h1 {\\n\\tpadding-bottom: 0.3em;\\n\\tline-height: 1.2;\\n\\tborder-bottom-width: 1px;\\n\\tborder-bottom-style: solid;\\n}\\n\\n.markdown-preview h1, h2, h3 {\\n\\tfont-weight: normal;\\n}\\n\\n.markdown-preview h1 code,\\n.markdown-preview h2 code,\\n.markdown-preview h3 code,\\n.markdown-preview h4 code,\\n.markdown-preview h5 code,\\n.markdown-preview h6 code {\\n\\tfont-size: inherit;\\n\\tline-height: auto;\\n}\\n\\n.markdown-preview table {\\n\\tborder-collapse: collapse;\\n}\\n\\n.markdown-preview table > thead > tr > th {\\n\\ttext-align: left;\\n\\tborder-bottom: 1px solid;\\n    border-color: rgba(255, 255, 255, 0.69);\\n}\\n\\n.theia-light .markdown-preview table > thead > tr > th {\\n\\tborder-color: rgba(0, 0, 0, 0.69);\\n}\\n\\n.markdown-preview table > thead > tr > th,\\n.markdown-preview table > thead > tr > td,\\n.markdown-preview table > tbody > tr > th,\\n.markdown-preview table > tbody > tr > td {\\n\\tpadding: 5px 10px;\\n}\\n\\n.markdown-preview table > tbody > tr + tr > td {\\n\\tborder-top: 1px solid;\\n}\\n\\n.markdown-preview blockquote {\\n\\tmargin: 0 7px 0 5px;\\n\\tpadding: 0 16px 0 10px;\\n\\tborder-left: 5px solid;\\n\\tbackground: var(--theia-textBlockQuote-background);\\n\\tborder-color: var(--theia-textBlockQuote-border);\\n}\\n\\n.markdown-preview code {\\n\\tfont-family: var(--theia-code-font-family);\\n\\tfont-size: var(--theia-code-font-size);\\n\\tline-height: var(--theia-code-line-height);\\n\\tcolor: var(--md-orange-800);\\n}\\n\\n.markdown-preview.wordWrap pre {\\n\\twhite-space: pre-wrap;\\n}\\n\\n.markdown-preview pre:not(.hljs),\\n.markdown-preview pre.hljs code > div {\\n\\tpadding: 16px;\\n\\tborder-radius: 3px;\\n\\toverflow: auto;\\n}\\n\\n.markdown-preview,\\n.markdown-preview pre code {\\n\\tcolor: var(--theia-editor-foreground);\\n\\ttab-size: 4;\\n}\\n\\n/** Theming */\\n\\n.theia-light .markdown-preview pre {\\n\\tbackground-color: rgba(220, 220, 220, 0.4);\\n}\\n\\n.theia-dark .markdown-preview pre {\\n\\tbackground-color: rgba(10, 10, 10, 0.4);\\n}\\n\\n.theia-high-contrast .markdown-preview pre {\\n\\tbackground-color: rgb(0, 0, 0);\\n}\\n\\n.vscode-high-contrast .markdown-preview h1 {\\n\\tborder-color: rgb(0, 0, 0);\\n}\\n\\n.theia-light .markdown-preview table > thead > tr > th {\\n\\tborder-color: rgba(0, 0, 0, 0.69);\\n}\\n\\n.theia-dark .markdown-preview table > thead > tr > th {\\n\\tborder-color: rgba(255, 255, 255, 0.69);\\n}\\n\\n.theia-light .markdown-preview h1,\\n.theia-light .markdown-preview hr,\\n.theia-light .markdown-preview table > tbody > tr + tr > td {\\n\\tborder-color: rgba(0, 0, 0, 0.18);\\n}\\n\\n.theia-dark .markdown-preview h1,\\n.theia-dark .markdown-preview hr,\\n.theia-dark .markdown-preview table > tbody > tr + tr > td {\\n\\tborder-color: rgba(255, 255, 255, 0.18);\\n}\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"/********************************************************************************\\n * Copyright (C) 2018 TypeFox and others.\\n *\\n * This program and the accompanying materials are made available under the\\n * terms of the Eclipse Public License v. 2.0 which is available at\\n * http://www.eclipse.org/legal/epl-2.0.\\n *\\n * This Source Code may also be made available under the following Secondary\\n * Licenses when the conditions for such availability set forth in the Eclipse\\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\\n * with the GNU Classpath Exception which is available at\\n * https://www.gnu.org/software/classpath/license.html.\\n *\\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\\n ********************************************************************************/\\n\\n/* Tomorrow Theme */\\n/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */\\n\\n/* Original theme - Copyright (C) 2013 Chris Kempson http://chriskempson.com\\n/* released under the MIT License */\\n/* https://github.com/chriskempson/tomorrow-theme */\\n\\n/*---------------------------------------------------------------------------------------------\\n *  Copyright (c) Microsoft Corporation. All rights reserved.\\n *  Licensed under the MIT License. See License.txt in the project root for license information.\\n *--------------------------------------------------------------------------------------------*/\\n\\n/* Copied from https://github.com/microsoft/vscode/blob/08537497eecd3172390194693d3d7c0ec8f52b70/extensions/markdown-language-features/media/tomorrow.css\\n * with modifications.\\n */\\n\\n/* This theme is used to style the output of the highlight.js library which is\\n * licensed under the BSD-3-Clause. See https://github.com/highlightjs/highlight.js/blob/master/LICENSE\\n */\\n\\n/* Tomorrow Comment */\\n.theia-preview-widget .hljs-comment,\\n.theia-preview-widget .hljs-quote {\\n\\tcolor: #8e908c;\\n}\\n\\n/* Tomorrow Red */\\n.theia-preview-widget .hljs-variable,\\n.theia-preview-widget .hljs-template-variable,\\n.theia-preview-widget .hljs-tag,\\n.theia-preview-widget .hljs-name,\\n.theia-preview-widget .hljs-selector-id,\\n.theia-preview-widget .hljs-selector-class,\\n.theia-preview-widget .hljs-regexp,\\n.theia-preview-widget .hljs-deletion {\\n\\tcolor: #c82829;\\n}\\n\\n/* Tomorrow Orange */\\n.theia-preview-widget .hljs-number,\\n.theia-preview-widget .hljs-built_in,\\n.theia-preview-widget .hljs-builtin-name,\\n.theia-preview-widget .hljs-literal,\\n.theia-preview-widget .hljs-type,\\n.theia-preview-widget .hljs-params,\\n.theia-preview-widget .hljs-meta,\\n.theia-preview-widget .hljs-link {\\n\\tcolor: #f5871f;\\n}\\n\\n/* Tomorrow Yellow */\\n.theia-preview-widget .hljs-attribute {\\n\\tcolor: #eab700;\\n}\\n\\n/* Tomorrow Green */\\n.theia-preview-widget .hljs-string,\\n.theia-preview-widget .hljs-symbol,\\n.theia-preview-widget .hljs-bullet,\\n.theia-preview-widget .hljs-addition {\\n\\tcolor: #718c00;\\n}\\n\\n/* Tomorrow Blue */\\n.theia-preview-widget .hljs-title,\\n.theia-preview-widget .hljs-section {\\n\\tcolor: #4271ae;\\n}\\n\\n/* Tomorrow Purple */\\n.theia-preview-widget .hljs-keyword,\\n.theia-preview-widget .hljs-selector-tag {\\n\\tcolor: #8959a8;\\n}\\n\\n.theia-preview-widget .hljs {\\n\\tdisplay: block;\\n\\toverflow-x: auto;\\n\\tcolor: #4d4d4c;\\n\\tpadding: 0.5em;\\n}\\n\\n.theia-preview-widget .hljs-emphasis {\\n\\tfont-style: italic;\\n}\\n\\n.theia-preview-widget .hljs-strong {\\n\\tfont-weight: bold;\\n}\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\nexports.i(require(\"-!../../../../../node_modules/css-loader/index.js!./preview-widget.css\"), \"\");\n\n// module\nexports.push([module.id, \"/********************************************************************************\\n * Copyright (C) 2018 TypeFox and others.\\n *\\n * This program and the accompanying materials are made available under the\\n * terms of the Eclipse Public License v. 2.0 which is available at\\n * http://www.eclipse.org/legal/epl-2.0.\\n *\\n * This Source Code may also be made available under the following Secondary\\n * Licenses when the conditions for such availability set forth in the Eclipse\\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\\n * with the GNU Classpath Exception which is available at\\n * https://www.gnu.org/software/classpath/license.html.\\n *\\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\\n ********************************************************************************/\\n\", \"\"]);\n\n// exports\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"/********************************************************************************\\n * Copyright (C) 2018 TypeFox and others.\\n *\\n * This program and the accompanying materials are made available under the\\n * terms of the Eclipse Public License v. 2.0 which is available at\\n * http://www.eclipse.org/legal/epl-2.0.\\n *\\n * This Source Code may also be made available under the following Secondary\\n * Licenses when the conditions for such availability set forth in the Eclipse\\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\\n * with the GNU Classpath Exception which is available at\\n * https://www.gnu.org/software/classpath/license.html.\\n *\\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\\n ********************************************************************************/\\n\\n.theia-preview-widget {\\n\\toverflow-y: auto;\\n    overflow-x: hidden;\\n}\\n\\n.theia-preview-widget .scrollBeyondLastLine {\\n\\tmargin-bottom: calc(100vh - var(--theia-content-line-height));\\n}\\n\\n.theia-preview-widget:focus {\\n    outline: 0;\\n    box-shadow: none;\\n}\\n\", \"\"]);\n\n// exports\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nexport * from './markdown-preview-handler';\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from 'inversify';\nimport URI from '@theia/core/lib/common/uri';\nimport { OpenerService } from '@theia/core/lib/browser';\nimport { isOSX } from '@theia/core/lib/common';\nimport { Path } from '@theia/core/lib/common/path';\n\nimport * as hljs from 'highlight.js';\nimport * as markdownit from 'markdown-it';\nimport * as anchor from 'markdown-it-anchor';\nimport { PreviewUri } from '../preview-uri';\nimport { PreviewHandler, RenderContentParams } from '../preview-handler';\nimport { PreviewOpenerOptions } from '../preview-contribution';\nimport { PreviewLinkNormalizer } from '../preview-link-normalizer';\n\n@injectable()\nexport class MarkdownPreviewHandler implements PreviewHandler {\n\n    readonly iconClass: string = 'markdown-icon file-icon';\n    readonly contentClass: string = 'markdown-preview';\n\n    @inject(OpenerService)\n    protected readonly openerService: OpenerService;\n\n    @inject(PreviewLinkNormalizer)\n    protected readonly linkNormalizer: PreviewLinkNormalizer;\n\n    canHandle(uri: URI): number {\n        return uri.scheme === 'file'\n            && (\n                uri.path.ext.toLowerCase() === '.md' ||\n                uri.path.ext.toLowerCase() === '.markdown'\n            ) ? 500 : 0;\n    }\n\n    renderContent(params: RenderContentParams): HTMLElement {\n        const content = params.content;\n        const renderedContent = this.getEngine().render(content, params);\n        const contentElement = document.createElement('div');\n        contentElement.classList.add(this.contentClass);\n        contentElement.innerHTML = renderedContent;\n        this.addLinkClickedListener(contentElement, params);\n        return contentElement;\n    }\n\n    protected addLinkClickedListener(contentElement: HTMLElement, params: RenderContentParams): void {\n        contentElement.addEventListener('click', (event: MouseEvent) => {\n            const candidate = (event.target || event.srcElement) as HTMLElement;\n            const link = this.findLink(candidate, contentElement);\n            if (link) {\n                event.preventDefault();\n                if (link.startsWith('#')) {\n                    this.revealFragment(contentElement, link);\n                } else {\n                    const preview = !(isOSX ? event.metaKey : event.ctrlKey);\n                    const uri = this.resolveUri(link, params.originUri, preview);\n                    this.openLink(uri, params.originUri);\n                }\n            }\n        });\n    }\n\n    protected findLink(element: HTMLElement, container: HTMLElement): string | undefined {\n        let candidate = element;\n        while (candidate.tagName !== 'A') {\n            if (candidate === container) {\n                return;\n            }\n            candidate = candidate.parentElement!;\n            if (!candidate) {\n                return;\n            }\n        }\n        return candidate.getAttribute('href') || undefined;\n    }\n\n    protected async openLink(uri: URI, originUri: URI): Promise<void> {\n        const opener = await this.openerService.getOpener(uri);\n        opener.open(uri, <PreviewOpenerOptions>{ originUri });\n    }\n\n    protected resolveUri(link: string, uri: URI, preview: boolean): URI {\n        const linkURI = new URI(link);\n        // URIs are always absolute, check link as a path whether it is relative\n        if (!new Path(link).isAbsolute && linkURI.scheme === uri.scheme &&\n            (!linkURI.authority || linkURI.authority === uri.authority)) {\n            // get a relative path from URI by trimming leading `/`\n            const relativePath = linkURI.path.toString().substring(1);\n            const resolvedUri = uri.parent.resolve(relativePath).withFragment(linkURI.fragment).withQuery(linkURI.query);\n            return preview ? PreviewUri.encode(resolvedUri) : resolvedUri;\n        }\n        return linkURI;\n    }\n\n    protected revealFragment(contentElement: HTMLElement, fragment: string): void {\n        const elementToReveal = this.findElementForFragment(contentElement, fragment);\n        if (!elementToReveal) {\n            return;\n        }\n        elementToReveal.scrollIntoView();\n    }\n\n    findElementForFragment(content: HTMLElement, link: string): HTMLElement | undefined {\n        const fragment = link.startsWith('#') ? link.substring(1) : link;\n        const filter: NodeFilter = {\n            acceptNode: (node: Node) => {\n                if (node instanceof HTMLHeadingElement) {\n                    if (node.tagName.toLowerCase().startsWith('h') && node.id === fragment) {\n                        return NodeFilter.FILTER_ACCEPT;\n                    }\n                    return NodeFilter.FILTER_SKIP;\n                }\n                return NodeFilter.FILTER_SKIP;\n            }\n        };\n        const treeWalker = document.createTreeWalker(content, NodeFilter.SHOW_ELEMENT, filter, false);\n        if (treeWalker.nextNode()) {\n            const element = treeWalker.currentNode as HTMLElement;\n            return element;\n        }\n        return undefined;\n    }\n\n    findElementForSourceLine(content: HTMLElement, sourceLine: number): HTMLElement | undefined {\n        const markedElements = content.getElementsByClassName('line');\n        let matchedElement: HTMLElement | undefined;\n        for (let i = 0; i < markedElements.length; i++) {\n            const element = markedElements[i];\n            const line = Number.parseInt(element.getAttribute('data-line') || '0');\n            if (line > sourceLine) {\n                break;\n            }\n            matchedElement = element as HTMLElement;\n        }\n        return matchedElement;\n    }\n\n    getSourceLineForOffset(content: HTMLElement, offset: number): number | undefined {\n        const lineElements = this.getLineElementsAtOffset(content, offset);\n        if (lineElements.length < 1) {\n            return undefined;\n        }\n        const firstLineNumber = this.getLineNumberFromAttribute(lineElements[0]);\n        if (firstLineNumber === undefined) {\n            return undefined;\n        }\n        if (lineElements.length === 1) {\n            return firstLineNumber;\n        }\n        const secondLineNumber = this.getLineNumberFromAttribute(lineElements[1]);\n        if (secondLineNumber === undefined) {\n            return firstLineNumber;\n        }\n        const y1 = lineElements[0].offsetTop;\n        const y2 = lineElements[1].offsetTop;\n        const dY = (offset - y1) / (y2 - y1);\n        const dL = (secondLineNumber - firstLineNumber) * dY;\n        const line = firstLineNumber + Math.floor(dL);\n        return line;\n    }\n\n    /**\n     * returns two significant line elements for the given offset.\n     */\n    protected getLineElementsAtOffset(content: HTMLElement, offset: number): HTMLElement[] {\n        let skipNext = false;\n        const filter: NodeFilter = {\n            acceptNode: (node: Node) => {\n                if (node instanceof HTMLElement) {\n                    if (node.classList.contains('line')) {\n                        if (skipNext) {\n                            return NodeFilter.FILTER_SKIP;\n                        }\n                        if (node.offsetTop > offset) {\n                            skipNext = true;\n                        }\n                        return NodeFilter.FILTER_ACCEPT;\n                    }\n                    return NodeFilter.FILTER_SKIP;\n                }\n                return NodeFilter.FILTER_REJECT;\n            }\n        };\n        const treeWalker = document.createTreeWalker(content, NodeFilter.SHOW_ELEMENT, filter, false);\n        const lineElements: HTMLElement[] = [];\n        while (treeWalker.nextNode()) {\n            const element = treeWalker.currentNode as HTMLElement;\n            lineElements.push(element);\n        }\n        return lineElements.slice(-2);\n    }\n\n    protected getLineNumberFromAttribute(element: HTMLElement): number | undefined {\n        const attribute = element.getAttribute('data-line');\n        return attribute ? Number.parseInt(attribute) : undefined;\n    }\n\n    protected engine: markdownit | undefined;\n    protected getEngine(): markdownit {\n        if (!this.engine) {\n            const engine: markdownit = this.engine = markdownit({\n                html: true,\n                linkify: true,\n                highlight: (str, lang) => {\n                    if (lang && hljs.getLanguage(lang)) {\n                        try {\n                            return '<pre class=\"hljs\"><code><div>' + hljs.highlight(lang, str, true).value + '</div></code></pre>';\n                        } catch { }\n                    }\n                    return '<pre class=\"hljs\"><code><div>' + engine.utils.escapeHtml(str) + '</div></code></pre>';\n                }\n            });\n            const renderers = ['heading_open', 'paragraph_open', 'list_item_open', 'blockquote_open', 'code_block', 'image', 'fence'];\n            for (const renderer of renderers) {\n                const originalRenderer = engine.renderer.rules[renderer];\n                engine.renderer.rules[renderer] = (tokens, index, options, env, self) => {\n                    const token = tokens[index];\n                    if (token.map) {\n                        const line = token.map[0];\n                        token.attrJoin('class', 'line');\n                        token.attrSet('data-line', line.toString());\n                    }\n                    return (originalRenderer)\n                        // tslint:disable-next-line:no-void-expression\n                        ? originalRenderer(tokens, index, options, env, self)\n                        : self.renderToken(tokens, index, options);\n                };\n            }\n            const originalImageRenderer = engine.renderer.rules['image'];\n            engine.renderer.rules['image'] = (tokens, index, options, env, self) => {\n                if (RenderContentParams.is(env)) {\n                    const documentUri = env.originUri;\n                    const token = tokens[index];\n                    if (token.attrs) {\n                        const srcAttr = token.attrs.find(a => a[0] === 'src');\n                        if (srcAttr) {\n                            const href = srcAttr[1];\n                            srcAttr[1] = this.linkNormalizer.normalizeLink(documentUri, href);\n                        }\n                    }\n                }\n                // tslint:disable-next-line:no-void-expression\n                return originalImageRenderer(tokens, index, options, env, self);\n            };\n\n            const domParser = new DOMParser();\n\n            const parseDOM = (html: string) =>\n                domParser.parseFromString(html, 'text/html').getElementsByTagName('body')[0] as HTMLElement;\n\n            const modifyDOM = (body: HTMLElement, tag: string, procedure: (element: Element) => void) => {\n                const elements = body.getElementsByTagName(tag);\n                for (let i = 0; i < elements.length; i++) {\n                    const element = elements.item(i);\n                    if (element) {\n                        procedure(element);\n                    }\n                }\n            };\n\n            const normalizeAllImgSrcInHTML = (html: string, normalizeLink: (link: string) => string) => {\n                const body = parseDOM(html);\n                modifyDOM(body, 'img', img => {\n                    const src = img.getAttributeNode('src');\n                    if (src) {\n                        src.nodeValue = normalizeLink(src.nodeValue || '');\n                    }\n                });\n                return body.innerHTML;\n            };\n\n            for (const name of ['html_block', 'html_inline']) {\n                const originalRenderer = engine.renderer.rules[name];\n                engine.renderer.rules[name] = (tokens, index, options, env, self) => {\n                    const currentToken = tokens[index];\n                    const content = currentToken.content;\n                    if (content.includes('<img') && RenderContentParams.is(env)) {\n                        const documentUri = env.originUri;\n                        currentToken.content = normalizeAllImgSrcInHTML(content, link => this.linkNormalizer.normalizeLink(documentUri, link));\n                    }\n                    // tslint:disable-next-line:no-void-expression\n                    return originalRenderer(tokens, index, options, env, self);\n                };\n            }\n\n            anchor(engine, {});\n        }\n        return this.engine;\n    }\n\n}\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable, inject } from 'inversify';\nimport { Widget } from '@phosphor/widgets';\nimport { FrontendApplicationContribution, WidgetOpenerOptions, NavigatableWidgetOpenHandler } from '@theia/core/lib/browser';\nimport { EditorManager, TextEditor, EditorWidget, EditorContextMenu } from '@theia/editor/lib/browser';\nimport { DisposableCollection, CommandContribution, CommandRegistry, Command, MenuContribution, MenuModelRegistry, Disposable } from '@theia/core/lib/common';\nimport { TabBarToolbarContribution, TabBarToolbarRegistry } from '@theia/core/lib/browser/shell/tab-bar-toolbar';\nimport URI from '@theia/core/lib/common/uri';\nimport { Position } from 'vscode-languageserver-types';\nimport { PreviewWidget } from './preview-widget';\nimport { PreviewHandlerProvider, } from './preview-handler';\nimport { PreviewUri } from './preview-uri';\nimport { PreviewPreferences } from './preview-preferences';\n\nimport debounce = require('lodash.debounce');\n\nexport namespace PreviewCommands {\n    /**\n     * No `label`. Otherwise, it would show up in the `Command Palette` and we already have the `Preview` open handler.\n     * See in (`WorkspaceCommandContribution`)[https://bit.ly/2DncrSD].\n     */\n    export const OPEN: Command = {\n        id: 'preview:open',\n        label: 'Open Preview',\n        iconClass: 'theia-open-preview-icon'\n    };\n    export const OPEN_SOURCE: Command = {\n        id: 'preview.open.source',\n        iconClass: 'theia-open-file-icon'\n    };\n}\n\nexport interface PreviewOpenerOptions extends WidgetOpenerOptions {\n    originUri?: URI;\n}\n\n@injectable()\n// eslint-disable-next-line max-len\nexport class PreviewContribution extends NavigatableWidgetOpenHandler<PreviewWidget> implements CommandContribution, MenuContribution, FrontendApplicationContribution, TabBarToolbarContribution {\n\n    readonly id = PreviewUri.id;\n    readonly label = 'Preview';\n\n    @inject(EditorManager)\n    protected readonly editorManager: EditorManager;\n\n    @inject(PreviewHandlerProvider)\n    protected readonly previewHandlerProvider: PreviewHandlerProvider;\n\n    @inject(PreviewPreferences)\n    protected readonly preferences: PreviewPreferences;\n\n    protected readonly synchronizedUris = new Set<string>();\n\n    protected scrollSyncLockOn: 'preview' | 'editor' | undefined = undefined;\n\n    protected scrollSyncLockTimeout: number | undefined;\n\n    onStart(): void {\n        this.onCreated(previewWidget => {\n            this.registerOpenOnDoubleClick(previewWidget);\n            this.registerEditorAndPreviewSync(previewWidget);\n        });\n        this.editorManager.onCreated(editorWidget => {\n            this.registerEditorAndPreviewSync(editorWidget);\n        });\n    }\n\n    protected async lockScrollSync(on: 'preview' | 'editor', delay: number = 50): Promise<void> {\n        this.scrollSyncLockOn = on;\n        if (this.scrollSyncLockTimeout) {\n            window.clearTimeout(this.scrollSyncLockTimeout);\n        }\n        this.scrollSyncLockTimeout = window.setTimeout(() => {\n            this.scrollSyncLockOn = undefined;\n        }, delay);\n    }\n\n    protected async registerEditorAndPreviewSync(source: PreviewWidget | EditorWidget): Promise<void> {\n        let uri: string;\n        let editorWidget: EditorWidget | undefined;\n        let previewWidget: PreviewWidget | undefined;\n        if (source instanceof EditorWidget) {\n            editorWidget = source;\n            uri = editorWidget.editor.uri.toString();\n            previewWidget = await this.getWidget(editorWidget.editor.uri);\n        } else {\n            previewWidget = source;\n            uri = previewWidget.getUri().toString();\n            editorWidget = await this.editorManager.getByUri(previewWidget.getUri());\n        }\n        if (!previewWidget || !editorWidget || !uri) {\n            return;\n        }\n        if (this.synchronizedUris.has(uri)) {\n            return;\n        }\n        const syncDisposables = new DisposableCollection();\n        previewWidget.disposed.connect(() => syncDisposables.dispose());\n        editorWidget.disposed.connect(() => syncDisposables.dispose());\n\n        const editor = editorWidget.editor;\n        syncDisposables.push(editor.onScrollChanged(debounce(() => {\n            if (this.scrollSyncLockOn === 'editor') {\n                // avoid recursive scroll synchronization\n                return;\n            }\n            this.lockScrollSync('preview');\n            const range = editor.getVisibleRanges();\n            if (range.length > 0) {\n                this.revealSourceLineInPreview(previewWidget!, range[0].start);\n            }\n        }), 100));\n        syncDisposables.push(this.synchronizeScrollToEditor(previewWidget, editor));\n\n        this.synchronizedUris.add(uri);\n        syncDisposables.push(Disposable.create(() => this.synchronizedUris.delete(uri)));\n    }\n\n    protected revealSourceLineInPreview(previewWidget: PreviewWidget, position: Position): void {\n        previewWidget.revealForSourceLine(position.line);\n    }\n\n    protected synchronizeScrollToEditor(previewWidget: PreviewWidget, editor: TextEditor): Disposable {\n        return previewWidget.onDidScroll(sourceLine => {\n            if (this.scrollSyncLockOn === 'preview') {\n                // avoid recursive scroll synchronization\n                return;\n            }\n            const line = Math.floor(sourceLine);\n            this.lockScrollSync('editor'); // avoid recursive scroll synchronization\n            editor.revealRange({\n                start: {\n                    line,\n                    character: 0\n                },\n                end: {\n                    line: line + 1,\n                    character: 0\n                }\n            }, { at: 'top' });\n        });\n    }\n\n    protected registerOpenOnDoubleClick(ref: PreviewWidget): void {\n        const disposable = ref.onDidDoubleClick(async location => {\n            const { editor } = await this.openSource(ref);\n            editor.revealPosition(location.range.start);\n            editor.selection = location.range;\n            ref.revealForSourceLine(location.range.start.line);\n        });\n        ref.disposed.connect(() => disposable.dispose());\n    }\n\n    canHandle(uri: URI): number {\n        if (!this.previewHandlerProvider.canHandle(uri)) {\n            return 0;\n        }\n        const editorPriority = this.editorManager.canHandle(uri);\n        if (editorPriority === 0) {\n            return 200;\n        }\n        if (PreviewUri.match(uri)) {\n            return editorPriority * 2;\n        }\n        return editorPriority * (this.openByDefault ? 2 : 0.5);\n    }\n\n    protected get openByDefault(): boolean {\n        return this.preferences['preview.openByDefault'];\n    }\n\n    async open(uri: URI, options?: PreviewOpenerOptions): Promise<PreviewWidget> {\n        const resolvedOptions = await this.resolveOpenerOptions(options);\n        return super.open(uri, resolvedOptions);\n    }\n    protected serializeUri(uri: URI): string {\n        return super.serializeUri(PreviewUri.decode(uri));\n    }\n\n    protected async resolveOpenerOptions(options?: PreviewOpenerOptions): Promise<PreviewOpenerOptions> {\n        const resolved: PreviewOpenerOptions = { mode: 'activate', ...options };\n        if (resolved.originUri) {\n            const ref = await this.getWidget(resolved.originUri);\n            if (ref) {\n                resolved.widgetOptions = { ...resolved.widgetOptions, ref };\n            }\n        }\n        return resolved;\n    }\n\n    registerCommands(registry: CommandRegistry): void {\n        registry.registerCommand(PreviewCommands.OPEN, {\n            execute: widget => this.openForEditor(widget),\n            isEnabled: widget => this.canHandleEditorUri(widget),\n            isVisible: widget => this.canHandleEditorUri(widget)\n        });\n        registry.registerCommand(PreviewCommands.OPEN_SOURCE, {\n            execute: widget => this.openSource(widget),\n            isEnabled: widget => widget instanceof PreviewWidget,\n            isVisible: widget => widget instanceof PreviewWidget\n        });\n    }\n\n    registerMenus(menus: MenuModelRegistry): void {\n        menus.registerMenuAction(EditorContextMenu.NAVIGATION, {\n            commandId: PreviewCommands.OPEN.id\n        });\n    }\n\n    registerToolbarItems(registry: TabBarToolbarRegistry): void {\n        registry.registerItem({\n            id: PreviewCommands.OPEN.id,\n            command: PreviewCommands.OPEN.id,\n            tooltip: 'Open Preview to the Side'\n        });\n        registry.registerItem({\n            id: PreviewCommands.OPEN_SOURCE.id,\n            command: PreviewCommands.OPEN_SOURCE.id,\n            tooltip: 'Open Source'\n        });\n    }\n\n    protected canHandleEditorUri(widget?: Widget): boolean {\n        const uri = this.getCurrentEditorUri(widget);\n        return !!uri && this.previewHandlerProvider.canHandle(uri);\n    }\n\n    protected getCurrentEditorUri(widget?: Widget): URI | undefined {\n        const current = this.getCurrentEditor(widget);\n        return current && current.editor.uri;\n    }\n\n    protected getCurrentEditor(widget?: Widget): EditorWidget | undefined {\n        const current = widget ? widget : this.editorManager.currentEditor;\n        return current instanceof EditorWidget && current || undefined;\n    }\n\n    protected async openForEditor(widget?: Widget): Promise<void> {\n        const ref = this.getCurrentEditor(widget);\n        if (!ref) {\n            return;\n        }\n        await this.open(ref.editor.uri, {\n            mode: 'reveal',\n            widgetOptions: { ref, mode: 'open-to-right' }\n        });\n    }\n\n    protected async openSource(ref: PreviewWidget): Promise<EditorWidget>;\n    protected async openSource(ref?: Widget): Promise<EditorWidget | undefined> {\n        if (ref instanceof PreviewWidget) {\n            return this.editorManager.open(ref.uri, {\n                widgetOptions: { ref, mode: 'open-to-left' }\n            });\n        }\n    }\n\n}\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { ContainerModule } from 'inversify';\nimport URI from '@theia/core/lib/common/uri';\nimport { CommandContribution, MenuContribution, bindContributionProvider, ResourceProvider } from '@theia/core/lib/common';\nimport { OpenHandler, WidgetFactory, FrontendApplicationContribution, NavigatableWidgetOptions } from '@theia/core/lib/browser';\nimport { TabBarToolbarContribution } from '@theia/core/lib/browser/shell/tab-bar-toolbar';\nimport { PreviewContribution } from './preview-contribution';\nimport { PreviewWidget, PreviewWidgetOptions } from './preview-widget';\nimport { PreviewHandler, PreviewHandlerProvider } from './preview-handler';\nimport { PreviewUri } from './preview-uri';\nimport { MarkdownPreviewHandler } from './markdown';\nimport { bindPreviewPreferences } from './preview-preferences';\nimport { PreviewLinkNormalizer } from './preview-link-normalizer';\n\nimport '../../src/browser/style/index.css';\nimport '../../src/browser/markdown/style/index.css';\n\nexport default new ContainerModule(bind => {\n    bindPreviewPreferences(bind);\n    bind(PreviewHandlerProvider).toSelf().inSingletonScope();\n    bindContributionProvider(bind, PreviewHandler);\n    bind(MarkdownPreviewHandler).toSelf().inSingletonScope();\n    bind(PreviewHandler).toService(MarkdownPreviewHandler);\n    bind(PreviewLinkNormalizer).toSelf().inSingletonScope();\n\n    bind(PreviewWidget).toSelf();\n    bind<WidgetFactory>(WidgetFactory).toDynamicValue(ctx => ({\n        id: PreviewUri.id,\n        async createWidget(options: NavigatableWidgetOptions): Promise<PreviewWidget> {\n            const { container } = ctx;\n            const resource = await container.get<ResourceProvider>(ResourceProvider)(new URI(options.uri));\n            const child = container.createChild();\n            child.bind<PreviewWidgetOptions>(PreviewWidgetOptions).toConstantValue({ resource });\n            return child.get(PreviewWidget);\n        }\n    })).inSingletonScope();\n\n    bind(PreviewContribution).toSelf().inSingletonScope();\n    [CommandContribution, MenuContribution, OpenHandler, FrontendApplicationContribution, TabBarToolbarContribution].forEach(serviceIdentifier =>\n        bind(serviceIdentifier).toService(PreviewContribution)\n    );\n});\n","/********************************************************************************\n * Copyright (C) 2017 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable, named } from 'inversify';\nimport URI from '@theia/core/lib/common/uri';\nimport { ContributionProvider, MaybePromise, Prioritizeable } from '@theia/core';\n\nexport const PreviewHandler = Symbol('PreviewHandler');\n\nexport interface RenderContentParams {\n    content: string;\n    originUri: URI;\n}\n\nexport namespace RenderContentParams {\n    export function is(params: object | undefined): params is RenderContentParams {\n        return !!params && 'content' in params && 'originUri' in params;\n    }\n}\n\nexport interface PreviewHandler {\n    readonly iconClass?: string;\n    canHandle(uri: URI): number;\n    renderContent(params: RenderContentParams): MaybePromise<HTMLElement | undefined>;\n    findElementForFragment?(content: HTMLElement, fragment: string): HTMLElement | undefined;\n    findElementForSourceLine?(content: HTMLElement, sourceLine: number): HTMLElement | undefined;\n    getSourceLineForOffset?(content: HTMLElement, offset: number): number | undefined;\n}\n\n@injectable()\nexport class PreviewHandlerProvider {\n\n    constructor(\n        @inject(ContributionProvider) @named(PreviewHandler)\n        protected readonly previewHandlerContributions: ContributionProvider<PreviewHandler>\n    ) { }\n\n    findContribution(uri: URI): PreviewHandler[] {\n        const prioritized = Prioritizeable.prioritizeAllSync(this.previewHandlerContributions.getContributions(), contrib =>\n            contrib.canHandle(uri)\n        );\n        return prioritized.map(c => c.value);\n    }\n\n    canHandle(uri: URI): boolean {\n        return this.findContribution(uri).length > 0;\n    }\n\n}\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { injectable } from 'inversify';\nimport URI from '@theia/core/lib/common/uri';\nimport { MiniBrowserEndpoint } from '@theia/mini-browser/lib/browser/location-mapper-service';\n\n@injectable()\nexport class PreviewLinkNormalizer {\n\n    protected urlScheme = new RegExp('^[a-z][a-z|0-9|\\+|\\-|\\.]*:', 'i');\n\n    normalizeLink(documentUri: URI, link: string): string {\n        try {\n            if (!this.urlScheme.test(link)) {\n                const location = documentUri.parent.resolve(link).path.toString();\n                return new MiniBrowserEndpoint().getRestUrl().resolve(location).toString();\n            }\n        } catch {\n            // ignore\n        }\n        return link;\n    }\n}\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { interfaces } from 'inversify';\nimport {\n    createPreferenceProxy,\n    PreferenceProxy,\n    PreferenceService,\n    PreferenceContribution,\n    PreferenceSchema\n} from '@theia/core/lib/browser';\n\nexport const PreviewConfigSchema: PreferenceSchema = {\n    type: 'object',\n    properties: {\n        'preview.openByDefault': {\n            type: 'boolean',\n            description: 'Open the preview instead of the editor by default.',\n            default: false\n        }\n    }\n};\n\nexport interface PreviewConfiguration {\n    'preview.openByDefault': boolean;\n}\n\nexport const PreviewPreferences = Symbol('PreviewPreferences');\nexport type PreviewPreferences = PreferenceProxy<PreviewConfiguration>;\n\nexport function createPreviewPreferences(\n    preferences: PreferenceService\n): PreviewPreferences {\n    return createPreferenceProxy(preferences, PreviewConfigSchema);\n}\n\nexport function bindPreviewPreferences(bind: interfaces.Bind): void {\n    bind(PreviewPreferences).toDynamicValue(ctx => {\n        const preferences = ctx.container.get<PreferenceService>(PreferenceService);\n        return createPreviewPreferences(preferences);\n    });\n    bind(PreferenceContribution).toConstantValue({ schema: PreviewConfigSchema });\n}\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport URI from '@theia/core/lib/common/uri';\n\nexport namespace PreviewUri {\n    export const id = 'code-editor-preview';\n    export const param = 'open-handler=' + id;\n    export function match(uri: URI): boolean {\n        return uri.query.indexOf(param) !== -1;\n    }\n    export function encode(uri: URI): URI {\n        if (match(uri)) {\n            return uri;\n        }\n        const params = [param];\n        if (uri.query) {\n            params.push(...uri.query.split('&'));\n        }\n        const query = params.join('&');\n        return uri.withQuery(query);\n    }\n    export function decode(uri: URI): URI {\n        if (!match(uri)) {\n            return uri;\n        }\n        const query = uri.query.split('&').filter(p => p !== param).join('&');\n        return uri.withQuery(query);\n    }\n}\n","/********************************************************************************\n * Copyright (C) 2018 TypeFox and others.\n *\n * This program and the accompanying materials are made available under the\n * terms of the Eclipse Public License v. 2.0 which is available at\n * http://www.eclipse.org/legal/epl-2.0.\n *\n * This Source Code may also be made available under the following Secondary\n * Licenses when the conditions for such availability set forth in the Eclipse\n * Public License v. 2.0 are satisfied: GNU General Public License, version 2\n * with the GNU Classpath Exception which is available at\n * https://www.gnu.org/software/classpath/license.html.\n *\n * SPDX-License-Identifier: EPL-2.0 OR GPL-2.0 WITH Classpath-exception-2.0\n ********************************************************************************/\n\nimport { inject, injectable } from 'inversify';\nimport { Resource, MaybePromise } from '@theia/core';\nimport { Navigatable } from '@theia/core/lib/browser/navigatable';\nimport { BaseWidget, Message, addEventListener } from '@theia/core/lib/browser';\nimport URI from '@theia/core/lib/common/uri';\nimport { Event, Emitter } from '@theia/core/lib/common';\nimport { Workspace, Location, Range } from '@theia/languages/lib/browser';\nimport { PreviewHandler, PreviewHandlerProvider } from './preview-handler';\nimport { ThemeService } from '@theia/core/lib/browser/theming';\nimport { EditorPreferences } from '@theia/editor/lib/browser';\n\nimport throttle = require('lodash.throttle');\nimport { Disposable } from '@theia/core/lib/common/disposable';\n\nexport const PREVIEW_WIDGET_CLASS = 'theia-preview-widget';\n\nconst DEFAULT_ICON = 'fa fa-eye';\n\nlet widgetCounter: number = 0;\n\nexport const PreviewWidgetOptions = Symbol('PreviewWidgetOptions');\nexport interface PreviewWidgetOptions {\n    resource: Resource\n}\n\n@injectable()\nexport class PreviewWidget extends BaseWidget implements Navigatable {\n\n    readonly uri: URI;\n    protected readonly resource: Resource;\n    protected previewHandler: PreviewHandler | undefined;\n    protected firstUpdate: (() => void) | undefined = undefined;\n    protected readonly onDidScrollEmitter = new Emitter<number>();\n    protected readonly onDidDoubleClickEmitter = new Emitter<Location>();\n    protected scrollBeyondLastLine: boolean;\n\n    constructor(\n        @inject(PreviewWidgetOptions) protected readonly options: PreviewWidgetOptions,\n        @inject(PreviewHandlerProvider) protected readonly previewHandlerProvider: PreviewHandlerProvider,\n        @inject(ThemeService) protected readonly themeService: ThemeService,\n        @inject(Workspace) protected readonly workspace: Workspace,\n        @inject(EditorPreferences) protected readonly editorPreferences: EditorPreferences,\n    ) {\n        super();\n        this.resource = this.options.resource;\n        this.uri = this.resource.uri;\n        this.id = 'preview-widget-' + widgetCounter++;\n        this.title.closable = true;\n        this.title.label = `Preview ${this.uri.path.base}`;\n        this.title.caption = this.title.label;\n        this.title.closable = true;\n\n        this.toDispose.push(this.onDidScrollEmitter);\n        this.toDispose.push(this.onDidDoubleClickEmitter);\n\n        this.addClass(PREVIEW_WIDGET_CLASS);\n        this.node.tabIndex = 0;\n        const previewHandler = this.previewHandler = this.previewHandlerProvider.findContribution(this.uri)[0];\n        if (!previewHandler) {\n            return;\n        }\n        this.title.iconClass = previewHandler.iconClass || DEFAULT_ICON;\n        this.initialize();\n    }\n\n    async initialize(): Promise<void> {\n        this.scrollBeyondLastLine = !!this.editorPreferences['editor.scrollBeyondLastLine'];\n        this.toDispose.push(this.editorPreferences.onPreferenceChanged(e => {\n            if (e.preferenceName === 'editor.scrollBeyondLastLine') {\n                this.scrollBeyondLastLine = !!e.newValue;\n                this.forceUpdate();\n            }\n        }));\n        this.toDispose.push(this.resource);\n        if (this.resource.onDidChangeContents) {\n            this.toDispose.push(this.resource.onDidChangeContents(() => this.update()));\n        }\n        const updateIfAffected = (affectedUri?: string) => {\n            if (!affectedUri || affectedUri === this.uri.toString()) {\n                this.update();\n            }\n        };\n        this.toDispose.push(this.workspace.onDidOpenTextDocument(document => updateIfAffected(document.uri)));\n        this.toDispose.push(this.workspace.onDidChangeTextDocument(params => updateIfAffected(params.textDocument.uri)));\n        this.toDispose.push(this.workspace.onDidCloseTextDocument(document => updateIfAffected(document.uri)));\n        this.toDispose.push(this.themeService.onThemeChange(() => this.update()));\n        this.firstUpdate = () => {\n            this.revealFragment(this.uri);\n        };\n        this.update();\n    }\n\n    protected onBeforeAttach(msg: Message): void {\n        super.onBeforeAttach(msg);\n        this.toDispose.push(this.startScrollSync());\n        this.toDispose.push(this.startDoubleClickListener());\n    }\n\n    protected preventScrollNotification: boolean = false;\n    protected startScrollSync(): Disposable {\n        return addEventListener(this.node, 'scroll', throttle((event: UIEvent) => {\n            if (this.preventScrollNotification) {\n                return;\n            }\n            const scrollTop = this.node.scrollTop;\n            this.didScroll(scrollTop);\n        }, 50));\n    }\n\n    protected startDoubleClickListener(): Disposable {\n        return addEventListener(this.node, 'dblclick', (event: MouseEvent) => {\n            if (!(event.target instanceof HTMLElement)) {\n                return;\n            }\n            const target = event.target as HTMLElement;\n            let node: HTMLElement | null = target;\n            while (node && node instanceof HTMLElement) {\n                if (node.tagName === 'A') {\n                    return;\n                }\n                node = node.parentElement;\n            }\n            const offsetParent = target.offsetParent as HTMLElement;\n            const offset = offsetParent.classList.contains(PREVIEW_WIDGET_CLASS) ? target.offsetTop : offsetParent.offsetTop;\n            this.didDoubleClick(offset);\n        });\n    }\n\n    getUri(): URI {\n        return this.uri;\n    }\n\n    getResourceUri(): URI | undefined {\n        return this.uri;\n    }\n    createMoveToUri(resourceUri: URI): URI | undefined {\n        return this.uri.withPath(resourceUri.path);\n    }\n\n    onActivateRequest(msg: Message): void {\n        super.onActivateRequest(msg);\n        this.node.focus();\n        this.update();\n    }\n\n    onUpdateRequest(msg: Message): void {\n        super.onUpdateRequest(msg);\n        this.performUpdate();\n    }\n\n    protected forceUpdate(): void {\n        this.previousContent = '';\n        this.update();\n    }\n\n    protected previousContent: string = '';\n    protected async performUpdate(): Promise<void> {\n        if (!this.resource) {\n            return;\n        }\n        const uri = this.resource.uri;\n        const document = this.workspace.textDocuments.find(d => d.uri === uri.toString());\n        const content: MaybePromise<string> = document ? document.getText() : await this.resource.readContents();\n        if (content === this.previousContent) {\n            return;\n        }\n        this.previousContent = content;\n        const contentElement = await this.render(content, uri);\n        this.node.innerHTML = '';\n        if (contentElement) {\n            if (this.scrollBeyondLastLine) {\n                contentElement.classList.add('scrollBeyondLastLine');\n            }\n            this.node.appendChild(contentElement);\n            if (this.firstUpdate) {\n                this.firstUpdate();\n                this.firstUpdate = undefined;\n            }\n        }\n    }\n\n    protected async render(content: string, originUri: URI): Promise<HTMLElement | undefined> {\n        if (!this.previewHandler || !this.resource) {\n            return undefined;\n        }\n        return this.previewHandler.renderContent({ content, originUri });\n    }\n\n    protected revealFragment(uri: URI): void {\n        if (uri.fragment === '' || !this.previewHandler || !this.previewHandler.findElementForFragment) {\n            return;\n        }\n        const elementToReveal = this.previewHandler.findElementForFragment(this.node, uri.fragment);\n        if (elementToReveal) {\n            this.preventScrollNotification = true;\n            elementToReveal.scrollIntoView();\n            window.setTimeout(() => {\n                this.preventScrollNotification = false;\n            }, 50);\n        }\n    }\n\n    revealForSourceLine(sourceLine: number): void {\n        this.internalRevealForSourceLine(sourceLine);\n    }\n    protected readonly internalRevealForSourceLine: (sourceLine: number) => void = throttle((sourceLine: number) => {\n        if (!this.previewHandler || !this.previewHandler.findElementForSourceLine) {\n            return;\n        }\n        const elementToReveal = this.previewHandler.findElementForSourceLine(this.node, sourceLine);\n        if (elementToReveal) {\n            this.preventScrollNotification = true;\n            elementToReveal.scrollIntoView();\n            window.setTimeout(() => {\n                this.preventScrollNotification = false;\n            }, 50);\n        }\n    }, 50);\n\n    get onDidScroll(): Event<number> {\n        return this.onDidScrollEmitter.event;\n    }\n\n    protected fireDidScrollToSourceLine(line: number): void {\n        this.onDidScrollEmitter.fire(line);\n    }\n\n    protected didScroll(scrollTop: number): void {\n        if (!this.previewHandler || !this.previewHandler.getSourceLineForOffset) {\n            return;\n        }\n        const offset = scrollTop;\n        const line = this.previewHandler.getSourceLineForOffset(this.node, offset);\n        if (line) {\n            this.fireDidScrollToSourceLine(line);\n        }\n    }\n\n    get onDidDoubleClick(): Event<Location> {\n        return this.onDidDoubleClickEmitter.event;\n    }\n\n    protected fireDidDoubleClickToSourceLine(line: number): void {\n        if (!this.resource) {\n            return;\n        }\n        this.onDidDoubleClickEmitter.fire({\n            uri: this.resource.uri.toString(),\n            range: Range.create({ line, character: 0 }, { line, character: 0 })\n        });\n    }\n\n    protected didDoubleClick(offsetTop: number): void {\n        if (!this.previewHandler || !this.previewHandler.getSourceLineForOffset) {\n            return;\n        }\n        const line = this.previewHandler.getSourceLineForOffset(this.node, offsetTop) || 0;\n        this.fireDidDoubleClickToSourceLine(line);\n    }\n\n}\n","\nvar content = require(\"!!../../../../../../node_modules/css-loader/index.js!./index.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../../node_modules/css-loader/index.js!./index.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../../node_modules/css-loader/index.js!./index.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js!./index.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js!./index.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js!./index.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}"],"sourceRoot":""}